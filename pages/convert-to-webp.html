<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convert to WebP - Free Online Image Converter Tool</title>
    <meta name="description" content="Convert your images to WebP format for better compression and quality. Free forever, no account needed, instant results. Supports JPG, PNG, and GIF formats.">
    <meta name="keywords" content="convert to webp, webp converter, image converter, jpg to webp, png to webp, free webp converter, no signup">
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üñºÔ∏è</text></svg>">
    
    <!-- Stylesheets -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="../assets/css/style.css" rel="stylesheet">
    
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="../assets/js/image-processing.js"></script>
    <script src="../assets/js/template-loader.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-257SVV94KB"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-257SVV94KB');
    </script>
    
    <style>
        /* Add custom styles for file upload feedback */
        .file-preview {
            display: none;
            max-width: 100%;
            max-height: 150px;
            margin: 10px auto;
            border-radius: 4px;
            overflow: hidden;
        }
        .file-item {
            display: flex;
            align-items: center;
            padding: 8px;
            margin-bottom: 8px;
            background-color: #f9fafb;
            border-radius: 4px;
            border: 1px solid #e5e7eb;
        }
        .file-item img {
            width: 40px;
            height: 40px;
            object-fit: cover;
            margin-right: 10px;
            border-radius: 4px;
        }
        .file-info {
            flex-grow: 1;
        }
        .file-name {
            font-weight: 500;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 200px;
        }
        .file-size {
            font-size: 12px;
            color: #6b7280;
        }
        .loading-indicator {
            display: none;
            width: 100%;
            text-align: center;
            padding: 20px 0;
        }
        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(59, 130, 246, 0.2);
            border-radius: 50%;
            border-top-color: #3b82f6;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* Benefits list styling */
        .benefits-list li {
            position: relative;
            padding-left: 1.75rem;
            margin-bottom: 0.5rem;
        }
        .benefits-list li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #10B981;
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-8">
        <article class="bg-white rounded-lg shadow-lg p-6 w-full max-w-4xl mx-auto">
            <header class="text-center mb-10">
                <div class="flex items-center justify-center mb-6">
                    <div class="mr-3 bg-blue-600 text-white p-2 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                    </div>
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-800">Convert Images to WebP</h1>
                </div>

                <p class="text-gray-600 max-w-2xl mx-auto">
                    <b>Free WebP converter</b> - Transform your images to WebP format for <i>better compression</i> and quality. 
                    <u>No signup required</u>, no watermarks, and it's completely free forever.
                </p>
            </header>

            <section class="mb-10">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Why Convert to WebP?</h2>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <p class="mb-3">WebP is a modern image format developed by Google that provides:</p>
                        <ul class="benefits-list">
                            <li><b>Superior compression</b> - smaller file sizes than JPG and PNG</li>
                            <li><b>Higher quality</b> at the same file size compared to other formats</li>
                            <li><b>Transparency support</b> like PNG but with smaller file sizes</li>
                            <li><b>Faster website loading</b> times for better user experience</li>
                            <li><b>Wide browser support</b> across major platforms</li>
                        </ul>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500">
                        <h3 class="font-medium text-blue-800 mb-2">Our Converter Advantages</h3>
                        <ul class="benefits-list text-blue-700">
                            <li><b>100% Free</b> - No hidden fees or premium features</li>
                            <li><b>No Account Needed</b> - Just upload and convert</li>
                            <li><b>Private & Secure</b> - Files processed in your browser</li>
                            <li><b>Batch Processing</b> - Convert multiple images at once</li>
                            <li><b>High Quality</b> - Adjustable compression settings</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="space-y-6">
                <!-- File Upload Section -->
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition-colors" id="upload-container">
                    <input type="file" id="image-upload" accept=".jpg,.jpeg,.png,.gif,.bmp,.tiff" multiple class="hidden">
                    <label for="image-upload" class="cursor-pointer">
                        <div class="space-y-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                            </svg>
                            <div class="text-gray-600">
                                <span class="font-medium">Click to upload</span> or drag and drop
                            </div>
                            <p class="text-sm text-gray-500">JPG, PNG, GIF, BMP or TIFF files (max 10MB each)</p>
                        </div>
                    </label>
                    <div id="file-preview-container" class="mt-4 space-y-2">
                        <!-- File previews will be added here -->
                    </div>
                </div>

                <!-- Loading indicator -->
                <div id="loading-indicator" class="loading-indicator">
                    <div class="loading-spinner"></div>
                    <p class="mt-2 text-gray-600">Processing your images...</p>
                </div>

                <!-- Conversion Options -->
                <div class="bg-gray-50 rounded-lg p-6">
                    <h4 class="text-lg font-semibold text-gray-800 mb-4">Conversion Settings</h4>
                    <div class="space-y-4">
                        <div>
                            <label for="quality-slider" class="block text-sm font-medium text-gray-700 mb-2">Quality Level</label>
                            <input type="range" min="1" max="100" value="80" class="w-full" id="quality-slider" aria-valuemin="1" aria-valuemax="100" aria-valuenow="80">
                            <div class="flex justify-between text-sm text-gray-500">
                                <span>Smaller File Size</span>
                                <span>Better Quality</span>
                            </div>
                            <div class="mt-1 text-center">
                                <span class="text-sm font-medium text-gray-700" id="quality-value">80</span>
                            </div>
                        </div>
                        
                        <div class="flex items-center">
                            <input type="checkbox" id="lossless" class="rounded text-blue-600">
                            <label for="lossless" class="ml-2 text-sm text-gray-700">Use lossless compression</label>
                        </div>

                        <div class="flex items-center">
                            <input type="checkbox" id="preserve-metadata" class="rounded text-blue-600">
                            <label for="preserve-metadata" class="ml-2 text-sm text-gray-700">Preserve image metadata</label>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex justify-center space-x-4">
                    <button id="convert-btn" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50" disabled>
                        Convert to WebP
                    </button>
                    <button id="reset-btn" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2">
                        Reset
                    </button>
                </div>

                <!-- Results Section (Initially Hidden) -->
                <div id="results-section" class="hidden space-y-4">
                    <div class="border-t border-gray-200 pt-6">
                        <h4 class="text-lg font-semibold text-gray-800 mb-4">Conversion Results</h4>
                        <div id="conversion-list" class="space-y-4">
                            <!-- Conversion results will be inserted here -->
                        </div>
                        
                        <!-- Download All Button -->
                        <div class="mt-6 text-center">
                            <button id="download-all-btn" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2">
                                Download All as ZIP
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <section class="mt-12 border-t border-gray-200 pt-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">How to Convert Images to WebP</h2>
                <ol class="list-decimal pl-6 mb-6 space-y-2">
                    <li><b>Upload your images</b> - Click the upload area or drag and drop your files</li>
                    <li><b>Adjust settings</b> - Set your preferred quality level and options</li>
                    <li><b>Convert</b> - Click the "Convert to WebP" button</li>
                    <li><b>Download</b> - Save individual files or all as a ZIP</li>
                </ol>

                <h5 class="font-medium text-gray-700 mb-2">WebP Compatibility</h5>
                <p class="text-gray-600 mb-6">
                    WebP is supported by all modern browsers including Chrome, Firefox, Edge, Opera, and Safari. 
                    For older browsers, consider providing fallback formats like JPG or PNG.
                </p>
            </section>

            <footer class="mt-10 border-t border-gray-200 pt-6 text-center text-gray-500 text-sm">
                <p>All image processing happens in your browser - your files are never uploaded to our servers.</p>
                <p class="mt-2">100% Free online image converter. No registration or email required.</p>
            </footer>
        </article>
    </main>

    <script>
        // Update quality value display
        const qualitySlider = document.getElementById('quality-slider');
        const qualityValue = document.getElementById('quality-value');
        
        qualitySlider.addEventListener('input', function() {
            qualityValue.textContent = this.value;
            // Update ARIA value for accessibility
            this.setAttribute('aria-valuenow', this.value);
        });
        
        // Reset button functionality
        const resetBtn = document.getElementById('reset-btn');
        const imageUpload = document.getElementById('image-upload');
        const resultsSection = document.getElementById('results-section');
        const convertBtn = document.getElementById('convert-btn');
        const filePreviewContainer = document.getElementById('file-preview-container');
        const loadingIndicator = document.getElementById('loading-indicator');
        
        resetBtn.addEventListener('click', function() {
            imageUpload.value = '';
            convertBtn.disabled = true;
            resultsSection.classList.add('hidden');
            document.getElementById('conversion-list').innerHTML = '';
            document.getElementById('quality-slider').value = 80;
            document.getElementById('quality-value').textContent = '80';
            document.getElementById('lossless').checked = false;
            document.getElementById('preserve-metadata').checked = false;
            filePreviewContainer.innerHTML = '';
        });
        
        // Handle drag and drop
        const dropZone = document.querySelector('.border-dashed');
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, preventDefaults, false);
        });
        
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        ['dragenter', 'dragover'].forEach(eventName => {
            dropZone.addEventListener(eventName, highlight, false);
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, unhighlight, false);
        });
        
        function highlight() {
            dropZone.classList.add('border-blue-500');
            dropZone.classList.add('bg-blue-50');
        }
        
        function unhighlight() {
            dropZone.classList.remove('border-blue-500');
            dropZone.classList.remove('bg-blue-50');
        }
        
        dropZone.addEventListener('drop', handleDrop, false);
        
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            imageUpload.files = files;
            
            if (files.length > 0) {
                convertBtn.disabled = false;
                displayFilePreviews(files);
            }
            
            // Create a change event to trigger any listeners
            const event = new Event('change');
            imageUpload.dispatchEvent(event);
        }
        
        // Handle file input change and display file previews
        imageUpload.addEventListener('change', function(e) {
            const files = e.target.files;
            
            if (files.length > 0) {
                convertBtn.disabled = false;
                displayFilePreviews(files);
            } else {
                convertBtn.disabled = true;
                filePreviewContainer.innerHTML = '';
            }
        });
        
        // Function to display file previews
        function displayFilePreviews(files) {
            filePreviewContainer.innerHTML = '';
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                
                // Check file size
                if (file.size > 10 * 1024 * 1024) { // 10MB
                    alert(`File "${file.name}" exceeds the 10MB limit and will be skipped.`);
                    continue;
                }
                
                // Create preview item
                const previewItem = document.createElement('div');
                previewItem.className = 'file-item';
                
                // Create thumbnail
                const thumbnail = document.createElement('img');
                thumbnail.alt = `Preview of ${file.name}`;
                
                // For images, create actual preview
                const fileUrl = URL.createObjectURL(file);
                thumbnail.src = fileUrl;
                
                // Create file info
                const fileInfo = document.createElement('div');
                fileInfo.className = 'file-info';
                
                const fileName = document.createElement('div');
                fileName.className = 'file-name';
                fileName.textContent = file.name;
                
                const fileSize = document.createElement('div');
                fileSize.className = 'file-size';
                fileSize.textContent = formatFileSize(file.size);
                
                fileInfo.appendChild(fileName);
                fileInfo.appendChild(fileSize);
                
                // Add elements to preview item
                previewItem.appendChild(thumbnail);
                previewItem.appendChild(fileInfo);
                
                // Add preview item to container
                filePreviewContainer.appendChild(previewItem);
            }
        }
        
        // Format file size
        function formatFileSize(bytes) {
            if (bytes < 1024) return `${bytes} bytes`;
            if (bytes < 1048576) return `${(bytes / 1024).toFixed(2)} KB`;
            return `${(bytes / 1048576).toFixed(2)} MB`;
        }
        
        // Enhanced convert button functionality with loading indicator
        convertBtn.addEventListener('click', async function() {
            const files = imageUpload.files;
            if (files.length === 0) return;
            
            // Show loading indicator
            loadingIndicator.style.display = 'block';
            convertBtn.disabled = true;
            
            // Get conversion settings
            const quality = parseInt(qualitySlider.value) / 100;
            const lossless = document.getElementById('lossless').checked;
            
            // Process conversions
            try {
                // Clear previous conversion list
                const conversionList = document.getElementById('conversion-list');
                conversionList.innerHTML = '';
                
                // Process each file
                let convertedWebPResults = [];
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    
                    // Update loading message
                    loadingIndicator.querySelector('p').textContent = `Processing ${i+1}/${files.length}: ${file.name}`;
                    
                    // Use ImageProcessor from image-processing.js
                    const result = await ImageProcessor.convertToWebP(file, quality, lossless);
                    convertedWebPResults.push(result);
                    
                    // Create result item in UI
                    const listItem = document.createElement('div');
                    listItem.className = 'bg-gray-50 p-4 rounded-lg flex flex-col md:flex-row items-center';
                    
                    const savingText = file.size > result.newSize ? 'saved' : 'increased';
                    const savingPercent = ((1 - (result.newSize / file.originalSize)) * 100).toFixed(1);
                    
                    listItem.innerHTML = `
                        <div class="w-full md:w-1/4 mb-2 md:mb-0">
                            <img src="${result.url}" alt="Converted image of ${file.name}" class="max-h-20 max-w-full mx-auto object-contain">
                        </div>
                        <div class="w-full md:w-2/4 px-4">
                            <p class="text-sm font-medium truncate">${result.name}</p>
                            <p class="text-xs text-gray-500">Original: ${formatFileSize(file.originalSize)} ‚Üí WebP: ${formatFileSize(result.newSize)}</p>
                            <p class="text-xs text-gray-500">${Math.abs(savingPercent)}% ${savingText}</p>
                        </div>
                        <div class="w-full md:w-1/4 mt-2 md:mt-0 text-right">
                            <button class="download-webp-btn bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700" data-index="${i}">
                                Download
                            </button>
                        </div>
                    `;
                    
                    conversionList.appendChild(listItem);
                }
                
                // Show results section
                resultsSection.classList.remove('hidden');
                
                // Add event listeners to download buttons
                const downloadBtns = document.querySelectorAll('.download-webp-btn');
                downloadBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const index = parseInt(btn.getAttribute('data-index'));
                        if (convertedWebPResults[index]) {
                            ImageProcessor.downloadBlob(convertedWebPResults[index]);
                        }
                    });
                });
                
                // Enable download all button
                const downloadAllBtn = document.getElementById('download-all-btn');
                if (downloadAllBtn) {
                    downloadAllBtn.addEventListener('click', () => {
                        if (convertedWebPResults.length === 1) {
                            ImageProcessor.downloadBlob(convertedWebPResults[0]);
                        } else if (convertedWebPResults.length > 1) {
                            // Create a ZIP file with all converted images
                            const zip = new JSZip();
                            
                            // Add files to zip
                            Promise.all(convertedWebPResults.map(result => {
                                return fetch(result.url)
                                    .then(res => res.blob())
                                    .then(blob => {
                                        zip.file(result.name, blob);
                                    });
                            }))
                            .then(() => {
                                return zip.generateAsync({type: 'blob'});
                            })
                            .then(content => {
                                const zipUrl = URL.createObjectURL(content);
                                const a = document.createElement('a');
                                a.href = zipUrl;
                                a.download = 'converted_webp_images.zip';
                                document.body.appendChild(a);
                                a.click();
                                document.body.removeChild(a);
                                URL.revokeObjectURL(zipUrl);
                            });
                        }
                    });
                }
            } catch (error) {
                console.error('Error during conversion:', error);
                alert('An error occurred during conversion. Please try again.');
            } finally {
                // Hide loading indicator
                loadingIndicator.style.display = 'none';
                
                // Enable convert button again
                convertBtn.disabled = false;
            }
        });
    </script>
</body>
</html> 